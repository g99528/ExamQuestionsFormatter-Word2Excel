<!DOCTYPE html>
<html lang="zh-CN"><head>
    <title>学习华北在线解析及格式化验证 - JSON.cn</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta http-equiv="Cache-Control" content="max-age=7200">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="baidu-site-verification" content="mlJsiTNxiD">
    <meta name="google-site-verification" content="CPogK9tQWL5XIDF9F9x_tJyy1HtpDI8Rv6owOEIkUvM">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="all">
    <meta name="author" content="json.cn">

<meta name="keywords" content="json,json在线解析,json格式化,json格式验证,json转xml,xml转json">
<meta name="description" content="Json中文网致力于在中国推广Json,并提供相关的Json解析、验证、格式化、压缩、编辑器以及Json与XML相互转换等服务">

    <link href="resource/bootstrap.css" rel="stylesheet">
    <link href="resource/font-awesome.css" rel="stylesheet">
    <link href="resource/base.css" rel="stylesheet">
    <style></style>
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="http://cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Favicons -->
<style type="text/css">.json_key{ color: #92278f;font-weight:bold;}.json_null{color: #f1592a;font-weight:bold;}.json_string{ color: #3ab54a;font-weight:bold;}.json_number{ color: #25aae2;font-weight:bold;}.json_boolean{ color: #f98280;font-weight:bold;}.json_link{ color: #61D2D6;font-weight:bold;}.json_array_brackets{}</style></head>
<body style="over-flow:hidden;">
  <header class="header">
      <div class="row-fluid">
          <div class="col-md-5" style="position:relative;">
              <a class="logo" href="#">
                  <span style="color:black;">学习</span><span style="color:red;">华北</span></a>

          </div>
          <nav class="col-md-7" style="padding:10px 0; " align="right">
              <div class="navi">
                  <!--<a href="https://www.json.cn/" data-placement="bottom">在线解析</a>-->
                  <!--&lt;!&ndash;<a href="http://lab.json.cn/" target="_blank"  data-placement="bottom">-->
                    <!--<span class="red">JSON实验室</span>-->
                <!--</a>&ndash;&gt;-->
                  <!--<a href="https://www.json.cn/wiki.html" data-placement="bottom">什么是JSON</a>-->
                  <!--<a href="https://www.json.cn/code.html" data-placement="bottom">JSON解析代码</a>-->
                  <!--<a href="https://www.json.cn/component.html" data-placement="bottom">JSON组件</a>-->

              </div>
          </nav>
          <br style="clear:both;">
      </div>
  </header>


<main class="row-fluid" style="height:85%;min-height:550px;">
    <div class="col-md-5" style="padding:0px;height:100%;">
        <div class="numberedtextarea-wrapper "><textarea id="json-src" placeholder="[请使用360极速浏览器打开本工具]在此输入考试试题,题号用#题号#分割开..." class="form-control" style="height:100%;height: 87vh;min-height:520px;padding:10px 10px 10px 30px;border:0;border-right:solid 1px #E5EBEE;border-bottom:solid 1px #eee;border-radius:0;resize: none; outline:none;font-size:10px;"></textarea><div class="numberedtextarea-line-numbers" style="padding-top: 10px; line-height: 14.2833px; font-family: menlo, monospace, Tahoma, &quot;微软雅黑&quot;, &quot;幼圆&quot;; width: 30px;"><div class="numberedtextarea-number numberedtextarea-number-1" style="margin-bottom: 10px;">1</div></div></div>
    </div>
    <div class="col-md-7" style="padding:0;position:relative;height:100%;">
        <div class="tool" style="position:absolute;">
            <a href="#" class="tip zip" title="" data-placement="bottom" data-original-title="压缩" style="color:#999;"><i class="fa fa-database"></i></a>
            <a href="#" class="tip xml" title="" data-placement="bottom" data-original-title="转XML" style="color:#999;"><i class="fa fa-file-excel-o"></i></a>
            <a href="#" class="tip shown" title="" data-placement="bottom" data-original-title="显示行号"><i class="glyphicon glyphicon-sort-by-order"></i></a>
            <a href="#" class="tip clear" title="" data-placement="bottom" data-original-title="清空"><i class="fa fa-trash"></i></a>
            <a href="#" class="tip copy" title="" data-clipboard-target="#json-target" data-placement="bottom" data-original-title="复制"><i class="fa fa-copy"></i></a>
            <a href="#" class="tip compress" title="" data-placement="bottom" data-original-title="折叠"><i class="fa fa-compress"></i></a>
            <!--<a href="#" class="tip six-options" title="" data-placement="bottom" data-original-title="六选项模式"><i class="glyphicon glyphicon-fullscreen"></i></a>-->
            <a href="#" class="tip parseJudge" title="" data-placement="bottom" data-original-title="解析判断题"><i class="glyphicon glyphicon-indent-left"></i></a>
            <a href="#" class="tip parseChoice" title="" data-placement="bottom" data-original-title="解析选择题"><i class="glyphicon glyphicon-indent-left"></i></a>
            <a href="#" class="tip parseMChoice" title="" data-placement="bottom" data-original-title="解析多选题"><i class="glyphicon glyphicon-indent-left"></i></a>
            <a href="#" class="tip convert" title="" data-placement="bottom" data-original-title="开始转换"><i class="glyphicon glyphicon glyphicon-log-in"></i></a>
            <a href="#" class="tip save" title="" data-placement="bottom" data-original-title="保存"><i class="fa fa-download"></i></a>
            <a href="#" class="tip setting" title="" data-placement="bottom" data-original-title="设置"><i class="glyphicon glyphicon-cog"></i></a>

        </div>
        <div id="right-box" style="width:100%;height: 87vh;min-height:520px;border:solid 1px #f6f6f6;border-radius:0;resize: none;overflow-y:scroll; outline:none;position:relative;font-size:12px;padding-top:40px;">
            <div id="line-num" style="background-color:#fafafa;padding:0px 8px;float:left;border-right:dashed 1px #E5EBEE;display:none;z-index:-1;color:#999;position:absolute;text-align:center;over-flow:hidden;"><div>1<div></div></div></div>
            <div class="ro" id="json-target" style="padding:0px 25px;white-space: pre-line;word-wrap:break-word;"><span class="json_number"></span></div>
        </div>
        <form id="form-save" method="POST"><input type="hidden" value="" id="txt-content" name="content"></form>
    </div>
    <br style="clear:both;">
</main>
<link href="resource/jquery.css" rel="stylesheet">
<script src="resource/hm.js"></script><script src="resource/jquery_003.js"></script>
<script src="resource/jquery_002.js"></script><div style="clear:both;"></div><div id="jquery-beauty-msg"></div>
<script src="resource/jquery_006.js"></script>
<script src="resource/jquery.js"></script>
<script src="resource/jquery_005.js"></script>
<script src="resource/json2.js"></script>
<script src="resource/jsonlint.js"></script>
<script src="resource/clipboard.js"></script>
<script src="resource/FileSaver.js"></script>
<script src="resource/bootstrap.js"></script>
<script src="resource/bootstrap-show-modal.js"></script>
<script src="resource/jquery_004.js"></script>
  <script src="resource/xlsx.full.min.js"></script>
  <script src="resource/json2xlsx.js"></script>
  <script src="resource/setting.js"></script>
<script type="text/javascript">
$('textarea').numberedtextarea();
var current_json = '';
var current_json_str = '';
var xml_flag = false;
var zip_flag = false;
var shown_flag = false;
var compress_flag = false;
// var sixOptions = false;//六选项模式
var parseJudge_flag = false;
var parseChoice_flag =  false;
var parseMChoice_flag = false;
var convert_flag = false;
var result_json = [];
//题号左右分隔符
var leftChar = '#';
var rightChar = '#';
//题号匹配器
var qidExp = new RegExp("("+leftChar+")\\d+("+rightChar+")","mg");
var qidExtractExp = new RegExp("(?<="+leftChar+")\\d+(?="+rightChar+")","mg");
$('.tip').tooltip();
function init(){
    xml_flag = false;
    zip_flag = false;
    shown_flag = false;
    compress_flag = false;
    renderLine();
    $('#json-target').html('');
    $('.xml').attr('style','color:#999;');
    $('.zip').attr('style','color:#999;');

}
function parse(){
    init();
    var content = $.trim($('#json-src').val());
    var result = '';
    if (content!='') {
        // //如果是xml,那么转换为json
        // if (content.substr(0,1) === '<' && content.substr(-1,1) === '>') {
        //     try{
        //         var json_obj = $.xml2json(content);
        //         content = JSON.stringify(json_obj);
        //     }catch(e){
        //         result = '解析错误：<span style="color: #f1592a;font-weight:bold;">' + e.message + '</span>';
        //         current_json_str = result;
        //         $('#json-target').html(result);
        //         return false;
        //     }
        //
        // }
//做试题基本面修复
        info("正在进行基础格式处理...");
        //替换换行
        content = content.replace(new RegExp("\n","gm"),"#ENTER#");
        //OCR不规则关键词替换
        content = content.replace(new RegExp("[）〉〕｝]","gm"),")").replace(new RegExp("[〔（〈｛]","gm"),"(");
        //删去空白字符
        content = content.replace(new RegExp("\\s","gm"),"");
        content = content.replace(new RegExp(" ","gm"),"");
        //替换:：为
        content = content.replace(new RegExp("(?<=[ABCDEF])[:：.,]","gm"),"、");
        // //修改题号
        // content = content.replace(new RegExp("(?<=\\d){1,3}[．..,](?!\\d)","gm"),"、");
        //替换半角符号
        content = content.replace(new RegExp("Ａ","gm"),"A").replace(new RegExp("Ｂ","gm"),"B").replace(new RegExp("Ｃ","gm"),"C").replace(new RegExp("Ｄ","gm"),"D").replace(new RegExp("Ｅ","gm"),"E").replace(new RegExp("Ｆ","gm"),"F");
        //还原换行
        content = content.replace(new RegExp("#ENTER#","gm"),"\n");
        // content = content.replace(new RegExp("","gm"),"");
        $('#json-src').val(content);
        //分析试题
        var regExp = new RegExp("("+leftChar+")\\d+("+rightChar+")","mg");
        var startIndex = 0;
        var qid = 0;
        var endIndex = 0;
        var json = {
            judges:[],
            choices:[],
            mChoices:[]
        };
        do{
            var question =  new Object();
            if(parseJudge_flag){
                question = {
                    qid:0,
                    stem:'',
                    answer:'',
                    type:'',
                    str:''
                };
            }
            if(parseChoice_flag){
                question = {
                    qid:0,
                    stem:'',
                    choiceA:'',
                    choiceB:'',
                    choiceC:'',
                    choiceD:'',
                    answer:'',
                    type:'',
                    str:''
                };
            }
            if(parseMChoice_flag){
                question = {
                    qid:0,
                    stem:'',
                    choiceA:'',
                    choiceB:'',
                    choiceC:'',
                    choiceD:'',
                    choiceE:'',
                    choiceF:'',
                    answer:'',
                    type:'',
                    str:''
                };
            }
            regExp.test(content);
            endIndex = regExp.lastIndex;
            //业务逻辑
            var str = content.substring(startIndex,endIndex);
            qid = extractQid(qid,str);
            question.qid = qid;
            //转换到末尾的情况
            if(endIndex < startIndex ){
                str = content.substring(startIndex,content.length);
                question.qid = qid + 1;
            }
            question.str = str;
            console.log("startIndex: "+startIndex +" endIndex: " + endIndex + " " +str);
            //转换开头的情况
            if(startIndex==0&&qid==0){
                qid = 1;
                startIndex = endIndex;
                continue;
            }
            //转换判断
            if(parseJudge_flag){
                var judge = extractJudge(question);
                if(judge!=null){
                    json.judges.push(judge);
                }
            }
            //转换单选
            if(parseChoice_flag){
                var choice = extractChoice(question);
                if(choice!=null){
                    json.choices.push(choice);
                }
            }
            //转换多选
            if(parseMChoice_flag){
                var mchoice = extractMultiChoice(question);
                if(mchoice!=null){
                    json.mChoices.push(mchoice);
                }
            }
            startIndex = endIndex;
        } while (regExp.lastIndex!=0);
        info("基础格式处理完成...");
        //导出
        if(convert_flag){
            try{
                current_json_str = JSON.stringify(json);
                result = new JSONFormat(current_json_str,4).toString();
                //根据类型保存
                if(parseJudge_flag) {
                    result_json = json.judges;
                }
                if(parseChoice_flag) {
                    result_json = json.choices;
                }
                if(parseMChoice_flag) {
                    result_json = json.mChoices;
                }

                }catch(e){
                result = '<span style="color: #f1592a;font-weight:bold;">' + e + '</span>';
                current_json_str = result;
            }
            $('#json-target').html(result);
        }
    }else{
        $('#json-target').html('');
    }

};
$('.xml').click(function(){
    if (xml_flag) {
        $('#json-src').keyup();
    }else{
        var result = $.json2xml(current_json);
        $('#json-target').html('<textarea style="width:100%;position:absolute;height: 80vh;min-height:480px;border:0;resize:none;">'+result+'</textarea>');
        xml_flag = true;
        $(this).attr('style','color:#15b374;');
    }
});
function extractQid(currentQid,content) {
    var r = qidExtractExp;
    var qidStr = '';
    qidStr = content.match(r);
    var qid = parseInt(qidStr);
    if(qidStr!=null&&qidStr.length==1){
        return qid-1;
    } else {
        return currentQid;
    }
}
function extractJudge(ques){
    var content = ques.str;
    if(content.indexOf("✘")>=0){
        ques.answer = "false";
    } else if(content.indexOf("✔")>=0){
        ques.answer = "true";
    } else {
        warning("第" + ques.qid + "题未发现答案[✘和✔]");
        return null;
    }
    //题干
    ques.stem = content.replace(new RegExp("[✘✔]","g"),"").replace(qidExp,"").trim();
    //设置题目类型
    ques.type = "judge";
    
    return ques;
}
function extractChoice(ques){
    var content = ques.str;
    var keyRegExp = /(\()[ABCD](\))/mg;
    var result = "";
    if((result = keyRegExp.exec(content))!=null){
        //  删去题目中的答案
        content = content.replace(result[0],"(   )");
        //  删去答案中的括号
        ques.answer = result[0].replace("(","").replace(")","");
    }else {
        warning("第" + ques.qid + "题未发现答案");
        return null;
    }
    //如果缺少A|B|C选项
    if (content.indexOf("A、")<0|| !content.indexOf("B、") <0|| !content.indexOf("C、") <0 ) {
        warning("第" + ques.qid + "题缺少A|B|C选项");
        return null;
    }
    //如果缺少D选项
    if (content.indexOf("D、")<0) {
        content = content + "D、 其他答案都不对";
        info("第" + ques.qid + "题缺少D选项[系统将自动补全]");
    }
    //删去题号
    content = content.replace(qidExp,"");
    //开始切割
    ques.stem = content.substring(0, content.lastIndexOf("A、")).trim();
    ques.choiceA = content.substring(content.lastIndexOf("A、") + 2, content.lastIndexOf("B、"));
    ques.choiceB = content.substring(content.lastIndexOf("B、") + 2, content.lastIndexOf("C、"));
    ques.choiceC = content.substring(content.lastIndexOf("C、") + 2, content.lastIndexOf("D、"));
    ques.choiceD = content.substring(content.lastIndexOf("D、") + 2, content.length);
    //设置题目类型
    ques.type = "choice";
    console.log(ques);
    return ques;
}
function extractMultiChoice(ques) {
    var content = ques.str;
    var keyRegExp = /(\()[ABCDEF、]{2,}(\))/mg;
    var result = "";
    if((result = keyRegExp.exec(content))!=null){
        //  删去题目中的答案
        content = content.replace(result[0],"(     )");
        //  删去答案中的括号
        ques.answer = result[0].replace(new RegExp("[\\(\\)、]","mg"),"");
    }else {
        warning("第" + ques.qid + "题未发现答案");
        return null;
    }
    //如果缺少A|B|C选项
    if (content.indexOf("A、")<0|| !content.indexOf("B、") <0|| !content.indexOf("C、") <0 ) {
        warning("第" + ques.qid + "题缺少A|B|C选项");
        return null;
    }
    //如果缺少D选项
    if (content.indexOf("D、")<0) {
        content = content + "D、 ";
        info("第" + ques.qid + "题缺少D选项");
    }
    //如果缺少E选项
    if (content.indexOf("E、")<0) {
        content = content + "E、 ";
    }
    //如果缺少F选项
    if (content.indexOf("F、")<0) {
        content = content + "F、 ";
    }
    //删去题号
    content = content.replace(qidExp,"");
    //开始切割
    ques.stem = content.substring(0, content.lastIndexOf("A、")).trim();
    ques.choiceA = content.substring(content.lastIndexOf("A、") + 2, content.lastIndexOf("B、"));
    ques.choiceB = content.substring(content.lastIndexOf("B、") + 2, content.lastIndexOf("C、"));
    ques.choiceC = content.substring(content.lastIndexOf("C、") + 2, content.lastIndexOf("D、"));
    ques.choiceD = content.substring(content.lastIndexOf("D、") + 2, content.lastIndexOf("E、"));
    ques.choiceE = content.substring(content.lastIndexOf("E、") + 2, content.lastIndexOf("F、"));
    ques.choiceF = content.substring(content.lastIndexOf("F、") + 2, content.length);
    //设置题目类型
    ques.type = "mchoice";
    console.log(ques);

    return ques;
}

function warning(message){

    $('#json-target').append("<br/><span style=\"color: #f1592a;font-weight:bold;\">警告："+message+"</span>");

}
function info(message) {

    $('#json-target').append("<br/><span style=\"color: rgba(105,105,105,0.78);font-weight:bold;\">提示："+message+"</span>");

}
function clearParseController(){
    parseChoice_flag = false;
    parseMChoice_flag = false;
    parseJudge_flag = false;
    convert_flag = false;
    $('.parseJudge').attr('style','color:#999;');
    $('.parseChoice').attr('style','color:#999;');
    $('.parseMChoice').attr('style','color:#999;');
}
//解析控制器
$('.parseJudge').click(function () {
    clearParseController();
    parseJudge_flag = true;
    $(this).attr('style','color:#15b374;');
    parse();
});
$('.parseChoice').click(function () {
    clearParseController();
    parseChoice_flag = true;
    $(this).attr('style','color:#15b374;');
    parse();
});
$('.parseMChoice').click(function () {
    clearParseController();
    parseMChoice_flag = true;
    $(this).attr('style','color:#15b374;');
    parse();
});
$('.convert').click(function () {
    // clearParseController();
    convert_flag = true;
    parse();
});
$('.shown').click(function(){
    if (!shown_flag) {
        renderLine();
        $('#line-num').show();
        $('.numberedtextarea-line-numbers').show();
        shown_flag = true;
        $(this).attr('style','color:#15b374;');
    }else{
        $('#line-num').hide();
        $('.numberedtextarea-line-numbers').hide();
        shown_flag = false;
        $(this).attr('style','color:#999;');
    }
});
function renderLine(){
    var line_num = $('#json-target').height()/20;
    $('#line-num').html("");
    var line_num_html = "";
    for (var i = 1; i < line_num+1; i++) {
        line_num_html += "<div>"+i+"<div>";
    }
    $('#line-num').html(line_num_html);
}
$('.zip').click(function(){
    if (zip_flag) {
        $('#json-src').keyup();
    }else{
        $('#json-target').html(current_json_str);
        zip_flag = true;
        $(this).attr('style','color:#15b374;');
    }

});
$('.compress').click(function(){
    if(!compress_flag){
        $(this).attr('style','color:#15b374;');
        //$(this).attr('title','取消折叠').tooltip('fixTitle').tooltip('show');
        $($(".fa-minus-square-o").toArray().reverse()).click();
        compress_flag = true;
    }else{
        while($(".fa-plus-square-o").length>0){
            $(".fa-plus-square-o").click();
        }
        compress_flag = false;
        $(this).attr('style','color:#555;');
        $(this).attr('title','折叠').tooltip('fixTitle').tooltip('show');
    }
});
$('.clear').click(function(){
     $('#json-src').val('');
     $('#json-target').html('');
    clearParseController();
});
(function($){
   $.fn.innerText = function(msg) {
         if (msg) {
            if (document.body.innerText) {
               for (var i in this) {
                  this[i].innerText = msg;
               }
            } else {
               for (var i in this) {
                  this[i].innerHTML.replace(/&amp;lt;br&amp;gt;/gi,"n").replace(/(&amp;lt;([^&amp;gt;]+)&amp;gt;)/gi, "");
               }
            }
            return this;
         } else {
            if (document.body.innerText) {
               return this[0].innerText;
            } else {
               return this[0].innerHTML.replace(/&amp;lt;br&amp;gt;/gi,"n").replace(/(&amp;lt;([^&amp;gt;]+)&amp;gt;)/gi, "");
            }
         }
   };
})(jQuery);
$('.save').click(function(){
    if(result_json.length>0){
        downloadExl(result_json);
    }else {
        alert("请先解析并点击转换按钮")
    }
    // var content = JSON.stringify(current_json);
    // $('#txt-content').val(content);
    //var text = "hell world";
    // var html = $('#json-target').html().replace(/\n/g,'<br/>').replace(/\n/g,'<br>');
    // var text = $('#json-target').innerText().replace('　　', '    ');
    // var blob = new Blob([text], {type: "application/json;charset=utf-8"});
    // var timestamp=new Date().getTime();
    // saveAs(blob, "format."+timestamp+".json");
});
$('.copy').click(function(){
    //$.msg("成功复制到粘贴板","color:#00D69C;");
    // $(this).tooltip('toggle')
    //       .attr('data-original-title', "复制成功！")
    //       .tooltip('fixTitle')
    //       .tooltip('toggle');
});
var clipboard = new Clipboard('.copy');
$('#json-src').keyup();
</script>


<footer style="padding:20px;text-align:center;color:#999;position:relative;">©2019 中国石化集团华北工程有限公司 right reserved.
    <a href="" download="学习华北试题解析结果.xlsx" id="downloadA"></a>
<!--<a href="http://www.miitbeian.gov.cn/" style="font-size:12px;" target="_blank">京ICP备15025187号-1</a>-->
<!--邮箱：service@json.cn-->
<!--<script>-->
<!--var _hmt = _hmt || [];-->
<!--(function() {-->
  <!--var hm = document.createElement("script");-->
  <!--hm.src = "https://hm.baidu.com/hm.js?2ea5d7a3a13a1da3236117fd8ee2b071";-->
  <!--var s = document.getElementsByTagName("script")[0];-->
  <!--s.parentNode.insertBefore(hm, s);-->
<!--})();-->
<!--</script>-->

</footer>


</body></html>